# 弹丸收集小车电控系统设计文档
## 一、电控系统准备阶段：软件学习、工具选型与协作体系搭建

### 功能描述
准备阶段是电控系统开发的基础支撑环节，核心目标包含三部分：一是掌握STM32CubeMX与编程软件的使用，构建开发技术能力；二是确定统一的编程工具，解决协作效率问题；三是搭建基于GitHub的协作体系，通过文档管理与任务分配规范开发流程，确保团队成员目标一致、进度同步，为后续硬件驱动与控制逻辑开发铺平道路。

### 开发历程

#### 1. 核心软件学习规划与落地
针对电控系统开发的技术需求，团队围绕“工具使用+功能实现”制定分层学习计划，确保成员快速具备独立开发能力：
- **STM32CubeMX学习**：聚焦“外设配置与代码生成”核心能力，以机械部件需求为导向（如舵机变形需定时器PWM、麦克纳姆轮驱动需GPIO方向控制），通过“案例实操+参数验证”的方式学习。例如，通过“配置TIM4生成20ms周期PWM驱动MG995舵机”“配置GPIO推挽输出控制L298N使能端”等小实验，掌握时钟树分配（72MHz主频下定时器分频计算）、引脚复用冲突规避等关键操作，1周内实现全员可独立生成基础外设初始化代码。
- **编程软件学习**：重点突破HAL库函数调用与调试逻辑，针对“电机转速调节”“串口数据收发”“中断回调函数编写”等高频场景

#### 2. 编程工具选型：从双工具并行到统一CLion
项目初期因成员技术背景差异采用双工具方案，后续因协作与稳定性问题优化为单一工具，具体迭代过程如下：
- **初始双工具选型原因**：
  - 选择**Keil5**：参考多数STM32入门教程，其对HAL库兼容性成熟，且具备完整的编译、下载、在线调试功能，适合零基础成员快速上手；
  - 选择**CLion**：一名成员此前有C++开发经验，熟悉CLion的CMake构建、代码自动补全与重构功能，编写复杂控制逻辑（如麦克纳姆轮差速算法）时效率更高，因此初期采用“一人用CLion、一人用Keil5”的并行方案，尝试兼容不同开发习惯。

- **双工具并行的核心问题**：
  - **协作效率低**：Keil5的Project工程与CLion的CMakeLists.txt工程文件不互通，成员需通过GitHub手动同步代码，且代码格式（如缩进、注释）、文件组织结构易出现差异，每次合并需花费1-2小时核对，严重拖慢开发进度；
  - **Keil5稳定性不足**：Keil5（V5.38版本）在Win11系统下偶发“工程文件损坏”“下载后程序跑飞”等问题，需重启软件或重新生成工程，单次故障排查耗时平均30分钟以上，影响开发连续性；
  - **功能局限性**：Keil5对多文件管理、代码搜索的支持较弱，随着驱动模块增多（如扇叶电机、舵机、麦克纳姆轮），查找函数、修改变量变得繁琐，而CLion的“全局搜索”“跳转定义”功能可大幅提升效率。

- **工具统一决策**：
  经过1周并行测试后，团队召开技术会议，综合评估“协作效率、稳定性、功能适配”三大维度，最终决定**全员切换至CLion**。核心依据：① CLion的现代化功能更适配复杂项目开发，且有经验成员可通过“一对一指导”帮助零基础成员快速掌握操作；② 解决双工具代码同步问题，减少无效沟通成本；③ 规避Keil5的兼容性故障，降低开发风险。

#### 3. 基于GitHub的协作体系搭建（经验成员带领）
为解决“开发进度不同步、文档缺失、任务责任不明确”问题，由组内有GitHub使用经验的成员牵头，搭建全员参与的协作体系丸收集小车电控开发”专属仓库。

#### 4. 核心问题与解决方案
- **环境配置问题**：CLion与ARM-GCC、OpenOCD工具链版本不兼容，出现“编译报错”“无法识别ST-Link下载器”。解决方案：参考B站教程与经验成员，统一安装ARM-GCC 10.3版本（与OpenOCD 0.11版本适配），在CLion“Settings”中手动指定工具链路径，同时通过“编译日志”定位缺失文件，逐步完善CMakeLists.txt配置；
- **GitHub协作问题**：部分成员不熟悉Git命令（如commit、push、pull），导致代码提交冲突。解决方案：经验成员开展1次Git基础培训，编写《Git命令速查手册》（含“拉取代码git pull、提交代码git add/commit/push、解决冲突步骤”），并通过“模拟提交”练习确保全员掌握基础操作；

#### 5. 阶段成果
- **技术能力**：全员掌握STM32CubeMX外设配置与CLion编程调试，可独立完成“舵机角度控制”“电机PWM调速”等基础功能开发；
- **协作体系**：搭建完成基于GitHub的文档管理与任务跟踪体系任务进度透明度提升；
- **工具统一**：实现CLion单一工具开发，代码同步效率较双工具阶段提升，Keil5稳定性问题彻底解决，开发故障排查时间缩短至10分钟以内。
